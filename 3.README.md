# MPO ASD Comparison: Simple vs Frequency-Band Reward

## Overview
Attempting to replicate the MPO agent with frequency based rewards and comparing with a simple MPO with a time based reward. Integrated ground based noise from zenodo. 



## Reward Function Comparison

### Simple MPO
```python
reward = -|pitch_error| / 1000.0 - 0.01 * |control_effort|
```

### Frequency-Band MPO 
```python
# 1. Extract 3 frequency bands from pitch error signal
#    - Low: < 3 Hz
#    - Mid: 8-30 Hz (observation band)
#    - High: > 40 Hz

# 2. Compute power in each band (via FFT)

# 3. Apply sigmoid scoring (lower power = higher score):
#    - Low band target: 1e-6 µrad²/Hz
#    - Mid band target: 1e-8 µrad²/Hz
#    - High band target: 1e-10 µrad²/Hz

# 4. Combined reward = low_score × mid_score × high_score
```

## ASD Comparision. 
![state_ASD_DM](https://raw.githubusercontent.com/Arush-Pimpalkar/RL_Arush/main/plots/DM_lighsaber_compare.png)

## Environment Architecture

### Data Sources

**Zenodo Data (`zenodo_data/`):**
- `noise_inputs/ITM_SEI_LIGO_O3.csv` - ITM seismic noise PSD
- `noise_inputs/ETM_SEI_LIGO_O3.csv` - ETM seismic noise PSD  
- `noise_inputs/DAMP_L_LIGO_O3.csv` - Damping loop L noise
- `noise_inputs/DAMP_P_LIGO_O3.csv` - Damping loop P noise
- `noise_inputs/SENSOR_PITCH_HARD/SOFT.csv` - Sensor readout noise
- `noise_inputs/LASER_RIN_LIGO_O3.csv` - Laser relative intensity noise
- `transfer_functions/tf_topL_2_tstP.csv` - Top stage to test mass transfer functions

**Lightsaber_X (`Lightsaber/Lightsaber_X/`):**
- LIGO O3 quad pendulum transfer functions (actuation → angle, radiation → angle)
- Cavity geometry parameters (ITM/ETM radii of curvature, arm length)
- Control filter designs (soft/hard mode)

### Noise Generation (Inverse FFT Method)
```python
# 1. Load PSD from zenodo CSV files
# 2. Interpolate to simulation frequency grid
# 3. Apply transfer functions (e.g., seismic → test mass pitch)
# 4. Generate colored noise via inverse FFT:
noise = irfft(white_noise × sqrt_psd × transfer_function) × fs
```

### Seismic Noise in Observation Space
The environment includes 7 seismic features in the 15-dim observation:
- `[8]` Raw seismic (ITM suspension noise)
- `[9-11]` Band-filtered seismic (0.1-1Hz, 1-8Hz, 8-30Hz)
- `[12-13]` Seismic velocity and acceleration
- `[14]` Seismic RMS (rolling 32-sample window)

This gives the agent direct access to seismic disturbance information for feedforward-style control.